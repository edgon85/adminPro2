<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title">Lista de {{ categoria }}</h4>
                <button type="button" class="btn btn-info btn-rounded" data-toggle="modal"
                    data-target="#add-contact">Agregar nuevo producto</button>
                <table id="demo-foo-addrow" class="table m-t-30 table-hover contact-list" data-page-size="10">
                    <thead>
                        <tr>
                            <!-- <th>No</th> -->
                            <th>Nombre</th>
                            <th>Categoría</th>
                            <th>Sub categoría</th>
                            <th>Acción</th>
                            <th>Acción</th>
                        </tr>
                    </thead>

                    <tbody *ngFor="let producto of productos | keys; let i = index">
                        <tr *ngIf="productos[producto].category == categoria">
                            <!-- <td>{{ i + 1 }}</td> -->
                            <td>
                                
                                 <img [src]="productos[producto].image.img1" alt="user" width="40" height="40"
                                    class="img-circle" />   
                               
                                {{ productos[producto].title }}
                            </td>
                            <td>{{ productos[producto].category }}</td>
                            <td>{{ productos[producto].sub_category }}</td>
                            <td>
                                <button (click)="obtenerProducto( productos[producto].slug )"
                                    class="btn btn-sm btn-outline-info" data-toggle="modal"
                                    data-target="#edit-contact">Editar</button>
                            <td>
                                <!-- <button type="button" class="btn btn-sm btn-icon btn-pure btn-outline delete-row-btn" data-toggle="tooltip" data-original-title="Delete"><i class="ti-close" aria-hidden="true"></i></button> -->
                                <button (click)="eliminarProducto( productos[producto].slug )"
                                    class="btn btn-sm btn-outline-danger">Eliminar</button>
                            </td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr>
                            <div id="add-contact" class="modal fade in" tabindex="-1" role="dialog"
                                aria-labelledby="myModalLabel" aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h4 class="modal-title" id="myModalLabel">Agregar nuevo producto</h4>
                                            <button type="button" class="close" data-dismiss="modal"
                                                aria-hidden="true">×</button>
                                        </div>
                                        <div class="modal-body">
                                            <!--Inicio de form en el modal-->
                                            <div class="container">
                                                <form #forma="ngForm" novalidate>
                                                    <div class="form-group">
                                                        <label class="control-label" for="">Nombre:</label>
                                                        <input class="form-control" [(ngModel)]="producto.title"
                                                            type="text" name="title" placeholder="Nombre" required>
                                                    </div>

                                                    <div class="form-group">
                                                        <label for="">Categoria:</label>
                                                        <select *ngIf="getCategory()" [(ngModel)]="producto.category"
                                                            name="category"
                                                            (change)="onSelectCategory($event.target.value)"
                                                            class="form-control input-lg" id="country" required>
                                                            <option value="">Seleccione una categoria</option>
                                                            <option *ngFor="let country of getCategory()"
                                                                value={{country.id}}>{{country.name}}</option>
                                                        </select>
                                                    </div>

                                                    <div class="form-group">
                                                        <label for="">Sub categoria:</label>
                                                        <select *ngIf="states" [(ngModel)]="producto.sub_category"
                                                            name="sub_category"
                                                            (change)="onSelectSubCategory($event.target.value)"
                                                            class="form-control input-lg" id="state" required>
                                                            <option value="">Seleccione subcategoria</option>
                                                            <option *ngFor="let state of states" value={{state.name}}>
                                                                {{state.name}}</option>
                                                        </select>
                                                    </div>

                                                    <div class="form-group">
                                                        <label for="">Descripcion:</label>
                                                        <textarea [(ngModel)]="producto.description" name="description"
                                                            class="form-control" id="" rows="3" required></textarea>
                                                    </div>

                                                    <div
                                                        class="fileupload btn btn-danger btn-rounded waves-effect waves-light">
                                                        <span><i class="ion-upload m-r-5"></i>Seleccionar Imagen</span>
                                                        <input type="file" [disabled]="!forma.valid" class="upload"
                                                            #myInputFile
                                                            (change)="onFileSelected( $event.target.files[0] )"
                                                            required>
                                                    </div>
                                                    <img *ngIf="!imagenTemp" class="w150 ml-3"
                                                        [src]="'assets/img/products/no-img.jpg'" alt=""
                                                        accept=".png, .jpg, .jpeg">
                                                    <img *ngIf="imagenTemp" class="w150 ml-3" [src]="imagenTemp" alt=""
                                                        accept=".png, .jpg, .jpeg">

                                                </form>
                                            </div>
                                            <!--fin del form del Modal-->
                                        </div>
                                        <div class="modal-footer">
                                            <button type="submit" [disabled]="!imagenSubir"
                                                (click)="guardarProducto( forma )" class="btn btn-info waves-effect"
                                                data-dismiss="modal">Guardar</button>
                                            <button type="button" class="btn btn-default waves-effect"
                                                data-dismiss="modal">Cancelar</button>
                                        </div>
                                    </div>
                                    <!-- /.modal-content -->
                                </div>
                                <!-- /.modal-dialog -->
                            </div>

                            <!-- modal para editar      -->
                         <div id="edit-contact" class="modal fade in" tabindex="-1" role="dialog"
                                aria-labelledby="myModalLabel" aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h4 class="modal-title" id="myModalLabel">Editar {{ producto.title }}</h4>
                                            <button type="button" class="close" data-dismiss="modal"
                                                aria-hidden="true">×</button>
                                        </div>

                                        <div class="modal-body">


                                            <!--Inicio de form en el modal-->
                                            <div class="container">
                                                <form #forma2="ngForm" novalidate>
                                                    <div class="form-group">
                                                        <label class="control-label" for="">Nombre:</label>
                                                        <input class="form-control" [(ngModel)]="producto.title"
                                                            type="text" name="title" placeholder="Nombre" required>
                                                    </div>

                                                    <div class="form-group">
                                                        <label for="">Categoria:</label>
                                                        <select *ngIf="getCategory()" [(ngModel)]="producto.category"
                                                            name="category"
                                                            (change)="onSelectCategory($event.target.value)"
                                                            class="form-control input-lg" id="country" required>
                                                            <option value="">Seleccione una categoria</option>
                                                            <option *ngFor="let country of getCategory()"
                                                                value={{country.id}}>{{country.name}}</option>
                                                        </select>
                                                    </div>

                                                    <div class="form-group">
                                                        <label for="">Sub categoria:</label>
                                                        <select *ngIf="states" [(ngModel)]="producto.sub_category"
                                                            name="sub_category"
                                                            (change)="onSelectSubCategory($event.target.value)"
                                                            class="form-control input-lg" id="state" required>
                                                            <option value="">Seleccione subcategoria</option>
                                                            <option *ngFor="let state of states" value={{state.name}}>
                                                                {{state.name}}</option>
                                                        </select>
                                                    </div>

                                                    <div class="form-group">
                                                        <label for="">Descripcion:</label>
                                                        <textarea [(ngModel)]="producto.description" name="description"
                                                            class="form-control" id="" rows="3" required></textarea>
                                                    </div>

                                                    <div
                                                        class="fileupload btn btn-danger btn-rounded waves-effect waves-light">
                                                        <span><i class="ion-upload m-r-5"></i>Seleccionar Imagen</span>
                                                        <input type="file" [disabled]="!forma.valid" class="upload"
                                                            #myInputFile
                                                            (change)="onFileUpdate( $event.target.files[0] )" required>
                                                    </div>
                                                    <img *ngIf="!imagenTemp" class="w150 ml-3"
                                                        [src]=" producto.image.img1 || 'assets/img/products/no-img.jpg'"
                                                        alt="" accept=".png, .jpg, .jpeg">
                                                    <img *ngIf="imagenTemp" class="w150 ml-3" [src]="imagenTemp" alt=""
                                                        accept=".png, .jpg, .jpeg">

                                                </form>
                                            </div>

                                            <!--fin del form del Modal-->

                                        </div>

                                        <div class="modal-footer">
                                            <button type="submit" (click)="actualizar( forma2 )"
                                                class="btn btn-info waves-effect"
                                                data-dismiss="modal">Actualizar</button>
                                            <button type="button" class="btn btn-default waves-effect"
                                                data-dismiss="modal">Cancelar</button>
                                        </div>
                                    </div>
                                    <!-- /.modal-content -->
                                </div>
                                <!-- /.modal-dialog -->
                            </div> 
                            <!-- end modal para editar-->
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    </div>
</div>